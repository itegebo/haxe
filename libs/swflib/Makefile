# Makefile generated by OCamake
# http://tech.motion-twin.com
.SUFFIXES : .ml .mli .cmo .cmi .cmx .mll .mly

CFLAGS= -I ../extlib -I ../extc -g
LIBS=

MODULES=as3code png swf actionScript as3parse swfPic as3hlparse swfParser

all: bytecode opt

bytecode: swflib.cma

opt: swflib.cmxa

swflib.cma: $(MODULES:=.cmo)
	ocamlc -o swflib.cma -a $(CFLAGS) $(LIBS) $(MODULES:=.cmo)

swflib.cmxa: $(MODULES:=.cmx)
	ocamlopt -o swflib.cmxa -a $(CFLAGS) $(LIBS) $(MODULES:=.cmx)

actionScript.cmo: swf.cmo
actionScript.cmx: swf.cmx
as3code.cmo: as3.cmi
as3code.cmx: as3.cmi
as3hlparse.cmo: as3parse.cmo as3hl.cmi as3code.cmo as3.cmi
as3hlparse.cmx: as3parse.cmx as3hl.cmi as3code.cmx as3.cmi
as3parse.cmo: as3code.cmo as3.cmi
as3parse.cmx: as3code.cmx as3.cmi
png.cmo: png.cmi
png.cmx: png.cmi
swf.cmo: as3.cmi
swf.cmx: as3.cmi
swfParser.cmo: swf.cmo as3parse.cmo actionScript.cmo
swfParser.cmx: swf.cmx as3parse.cmx actionScript.cmx
swfPic.cmo: swf.cmo png.cmi
swfPic.cmx: swf.cmx png.cmx


clean:
	rm -f swflib.cma swflib.cmxa swflib.lib swflib.a as3.cmi as3hl.cmi
	rm -f $(MODULES:=.cmo) $(MODULES:=.cmx) $(MODULES:=.obj) $(MODULES:=.cmi) $(MODULES:=.o)

# SUFFIXES
.ml.cmo:
	ocamlc $(CFLAGS) -c $<

.ml.cmx:
	ocamlopt $(CFLAGS) -c $<

.mli.cmi:
	ocamlc $(CFLAGS) $<

.mll.ml:
	ocamllex $<

.mly.ml:
	ocamlyacc $<

